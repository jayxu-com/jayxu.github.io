---
id: 15472
title: 'Mini Java编译器（三）'
date: '2005-03-16T11:20:39+08:00'
author: Jay
layout: post
guid: 'https://www.jayxu.com/?p=15472'
permalink: /2005/03/16/15472
posturl_add_url:
    - 'yes'
views:
    - '2222'
dsq_thread_id:
    - '4930012959'
duoshuo_thread_id:
    - '6.3356053326974E+18'
---

<h2>三、属性翻译文法</h2>
<h3>主类声明（MainClass）</h3>
<table>
<tbody>
<tr>
<td>&lt;MainClass&gt;</td>
<td>::=</td>
<td>"class" &lt;Identifier&gt;<sub>↑&lt;id_name1&gt;</sub></td>
</tr>
<tr>
<td></td>
<td></td>
<td>@fillMemory<sub>↓&lt;id_name1&gt;</sub><sub>↑&lt;id_address&gt;</sub></td>
</tr>
<tr>
<td></td>
<td></td>
<td>@fillTable<sub>↓&lt;id_name1&gt;,&lt;id_address&gt;</sub></td>
</tr>
<tr>
<td></td>
<td></td>
<td>@fillTree<sub>↓&lt;id_name1&gt;</sub></td>
</tr>
<tr>
<td></td>
<td></td>
<td>"{" "public" "static" "void" "main" "(" "String" "[" "]"</td>
</tr>
<tr>
<td></td>
<td></td>
<td>&lt;Identifier&gt;<sub>↑&lt;id_name2&gt;,&lt;id_belongsTo&gt;=&lt;id_name1&gt;,&lt;id_type&gt;=StringArrayType</sub></td>
</tr>
<tr>
<td></td>
<td></td>
<td>@fillTable<sub>↓&lt;id_name2&gt;,&lt;id_belongsTo&gt;</sub></td>
</tr>
<tr>
<td></td>
<td></td>
<td>"{" &lt;PrintStatement&gt; "}" "}"</td>
</tr>
</tbody>
</table>
&nbsp;
<h3>类声明（ClassDeclaration）</h3>
<table>
<tbody>
<tr>
<td>&lt;ClassDeclaration&gt;</td>
<td>::=</td>
<td>"class" &lt;Identifier&gt;<sub>↑&lt;id_name&gt;</sub></td>
</tr>
<tr>
<td></td>
<td></td>
<td>@checkTable<sub>↓&lt;id_name&gt;</sub></td>
</tr>
<tr>
<td></td>
<td></td>
<td>@fillMemory<sub>↓&lt;id_name1&gt;</sub><sub>↑&lt;id_address&gt;</sub></td>
</tr>
<tr>
<td></td>
<td></td>
<td>@fillTable<sub>↓&lt;id_name&gt;,&lt;id_address&gt;</sub></td>
</tr>
<tr>
<td></td>
<td></td>
<td>@fillTree<sub>↓&lt;node_name&gt;=&lt;id_name&gt;</sub></td>
</tr>
<tr>
<td></td>
<td></td>
<td>"{" ( VarDeclaration )* ( MethodDeclaration )* "}"</td>
</tr>
</tbody>
</table>
&nbsp;
<h3>类继承声明（ClassExtendsDeclaration）</h3>
<table>
<tbody>
<tr>
<td>&lt;ClassExtendsDeclaration&gt;</td>
<td>::=</td>
<td>"class" &lt;Identifier&gt;<sub>↑&lt;id_name1&gt;</sub></td>
</tr>
<tr>
<td></td>
<td></td>
<td>@checkTable<sub>↓&lt;id_name1&gt;</sub></td>
</tr>
<tr>
<td></td>
<td></td>
<td>"extends" &lt;Identifier&gt;<sub>↑&lt;id_name2&gt;</sub></td>
</tr>
<tr>
<td></td>
<td></td>
<td>@checkTree<sub>↓&lt;id_name2&gt;</sub></td>
</tr>
<tr>
<td></td>
<td></td>
<td>@fillMemory<sub>↓&lt;id_name1&gt;</sub><sub>↑&lt;id_address&gt;</sub></td>
</tr>
<tr>
<td></td>
<td></td>
<td>@fillTable<sub>↓&lt;id_name1&gt;,&lt;id_name2&gt;,&lt;id_address&gt;</sub></td>
</tr>
<tr>
<td></td>
<td></td>
<td>@fillTree<sub>↓&lt;child_name&gt;=&lt;id_name1&gt;,&lt;parent_name&gt;=&lt;id_name2&gt;</sub></td>
</tr>
<tr>
<td></td>
<td></td>
<td>"{" ( VarDeclaration )* ( MethodDeclaration )* "}"</td>
</tr>
</tbody>
</table>
&nbsp;
<h3>变量声明（VarDeclaration）</h3>
<table>
<tbody>
<tr>
<td>&lt;VarDeclaration&gt;</td>
<td>::=</td>
<td>&lt;Type&gt;<sub>↑&lt;id_type&gt;</sub></td>
</tr>
<tr>
<td></td>
<td></td>
<td>&lt;Idetifier&gt;<sub>↑&lt;id_name&gt;,&lt;id_belongsTo&gt;</sub> “;”</td>
</tr>
<tr>
<td></td>
<td></td>
<td>@checkTable<sub>↓&lt;id_name&gt;,&lt;id_belongsTo&gt;</sub></td>
</tr>
<tr>
<td></td>
<td></td>
<td>@fillMemory<sub>↓&lt;id_name&gt;</sub><sub>↑&lt;id_address&gt;</sub></td>
</tr>
<tr>
<td></td>
<td></td>
<td>@fillTable<sub>↓&lt;id_name&gt;,&lt;id_type&gt;,&lt;id_belongsTo&gt;,&lt;address&gt;</sub></td>
</tr>
<tr>
<td> &lt;Type&gt;<sub>↑&lt;id_type&gt;</sub></td>
<td>::=</td>
<td>&lt;ArrayType&gt;<sub>↑&lt;id_type&gt;=ArrayType</sub></td>
</tr>
<tr>
<td></td>
<td></td>
<td>|&lt;BooleanType&gt;<sub>↑&lt;id_type&gt;=BooleanType</sub></td>
</tr>
<tr>
<td></td>
<td></td>
<td>|&lt;IntegerType&gt;<sub>↑&lt;id_type&gt;=IntegerType</sub></td>
</tr>
</tbody>
</table>
&nbsp;
<h3>方法声明（MethodDeclaration）</h3>
<table>
<tbody>
<tr>
<td>&lt;MethodDeclaration&gt;</td>
<td>::=</td>
<td>"public" &lt;Type&gt;<sub>↑&lt;id_type&gt;</sub></td>
</tr>
<tr>
<td></td>
<td></td>
<td>&lt;Identifier&gt;<sub>↑&lt;id_name&gt;,&lt;id_belongsTo&gt;</sub></td>
</tr>
<tr>
<td></td>
<td></td>
<td>@checkTable<sub>↓&lt;id_name&gt;,&lt;id_belongsTo&gt;</sub></td>
</tr>
<tr>
<td></td>
<td></td>
<td>@fillMemory<sub>↓&lt;id_name&gt;</sub><sub>↑&lt;id_address&gt;</sub></td>
</tr>
<tr>
<td></td>
<td></td>
<td>@fillTable<sub>↓&lt;id_name&gt;,&lt;id_type&gt;,&lt;id_belongsTo&gt;,&lt;id_address&gt;</sub></td>
</tr>
<tr>
<td></td>
<td></td>
<td>"(" ( &lt;FormalParameterList&gt; )? ")"</td>
</tr>
<tr>
<td></td>
<td></td>
<td>"{" ( &lt;VarDeclaration&gt; )* ( &lt;Statement&gt; )* "return"</td>
</tr>
<tr>
<td></td>
<td></td>
<td>&lt;Expression&gt;<sub>↑&lt;exp_type&gt;,&lt;exp_value&gt;</sub></td>
</tr>
<tr>
<td></td>
<td></td>
<td>@checkType<sub>↓&lt;id_type&gt;,&lt;exp_type&gt; </sub>";" "}"</td>
</tr>
<tr>
<td>&lt;Type&gt;<sub>↑&lt;id_type&gt;</sub></td>
<td>::=</td>
<td>&lt;ArrayType&gt;<sub>↑&lt;id_type&gt;=ArrayType</sub></td>
</tr>
<tr>
<td></td>
<td></td>
<td>|&lt;BooleanType&gt;<sub>↑&lt;id_type&gt;=BooleanType</sub></td>
</tr>
<tr>
<td></td>
<td></td>
<td>|&lt;IntegerType&gt;<sub>↑&lt;id_type&gt;=IntegerType</sub></td>
</tr>
<tr>
<td>&lt;FormalParameterList&gt;</td>
<td>::=</td>
<td>&lt;FormalParameter&gt;</td>
</tr>
<tr>
<td></td>
<td></td>
<td>( &lt;FormalParameterRest&gt; )*</td>
</tr>
<tr>
<td>&lt;FormalParameter&gt;</td>
<td>::=</td>
<td>&lt;Type&gt;<sub>↑&lt;id_type&gt;</sub></td>
</tr>
<tr>
<td></td>
<td></td>
<td>&lt;Identifier&gt;<sub>↑&lt;id_name&gt;,&lt;id_belongsTo&gt;</sub></td>
</tr>
<tr>
<td></td>
<td></td>
<td>@checkTable<sub>↓&lt;id_name&gt;,&lt;id_belongsTo&gt;</sub></td>
</tr>
<tr>
<td></td>
<td></td>
<td>@fillTable<sub>↓&lt;id_name&gt;,&lt;id_type&gt;</sub></td>
</tr>
<tr>
<td>&lt;FormalParameterRest&gt;</td>
<td>::=</td>
<td>"," &lt;FormalParameter&gt;</td>
</tr>
</tbody>
</table>
&nbsp;
<h3>赋值语句（AssignmentStatement）</h3>
<table>
<tbody>
<tr>
<td>&lt;AssignmentStatement&gt;</td>
<td>::=</td>
<td>&lt;Identifier&gt;<sub>↑id_name</sub>@checkTable<sub>↓&lt;id_name&gt;</sub><sub>↑&lt;id_type&gt;</sub></td>
</tr>
<tr>
<td></td>
<td></td>
<td>“=” &lt;Expression&gt;<sub>↑&lt;exp_type&gt;,&lt;exp_value&gt; </sub>“;”</td>
</tr>
<tr>
<td></td>
<td></td>
<td>@checkType<sub>↓&lt;id_type&gt;,&lt;exp_type&gt;</sub></td>
</tr>
<tr>
<td></td>
<td></td>
<td>@generateCode<sub>↓&lt;stmt_type&gt;=stmt_assign,&lt;extra_para&gt;</sub></td>
</tr>
</tbody>
</table>
&nbsp;
<h3>数组元素赋值语句（ArrayAssignmentStatement）</h3>
<table>
<tbody>
<tr>
<td>&lt;ArrayAssignmentStatement&gt;</td>
<td>::=</td>
<td>&lt;Identifier&gt;<sub>↑&lt;id_name&gt;</sub>@checkTable<sub>↓&lt;id_name&gt;</sub><sub>↑&lt;id_type&gt;</sub></td>
</tr>
<tr>
<td></td>
<td></td>
<td>@checkType<sub>↓&lt;id_type&gt;,ArrayType</sub></td>
</tr>
<tr>
<td></td>
<td></td>
<td>"[" &lt;Expression&gt;<sub>↑&lt;exp_type1&gt;,&lt;exp_value1&gt;</sub></td>
</tr>
<tr>
<td></td>
<td></td>
<td>@checkType<sub>↓&lt;exp_type1&gt;,IntegerType</sub></td>
</tr>
<tr>
<td></td>
<td></td>
<td>"]" "=" &lt;Expression&gt;<sub>↑&lt;exp_type2&gt;,&lt;exp_value2&gt;</sub></td>
</tr>
<tr>
<td></td>
<td></td>
<td>@checkType<sub>↓&lt;exp_type2&gt;,IntegerType</sub> ";"</td>
</tr>
<tr>
<td></td>
<td></td>
<td>@generateCode<sub>↓&lt;stmt_type&gt;=stmt_array_assign,&lt;extra_para&gt;</sub></td>
</tr>
</tbody>
</table>
&nbsp;
<h3>if语句（IfStatement）</h3>
<table>
<tbody>
<tr>
<td>&lt;IfStatement&gt;</td>
<td>::=</td>
<td>"if" "(" &lt;Expression&gt;<sub>↑&lt;exp_type&gt;,&lt;exp_value&gt;</sub></td>
</tr>
<tr>
<td></td>
<td></td>
<td>@checkType<sub>↓&lt;exp_type&gt;,BooleanType</sub></td>
</tr>
<tr>
<td></td>
<td></td>
<td>")" &lt;Statement&gt; "else" &lt;Statement&gt;</td>
</tr>
<tr>
<td></td>
<td></td>
<td>@generateCode<sub>↓&lt;stmt_type&gt;=stmt_if,&lt;extra_para&gt;</sub></td>
</tr>
</tbody>
</table>
&nbsp;
<h3>while语句（WhileStatemen）</h3>
<table>
<tbody>
<tr>
<td>&lt;WhileStatement&gt;</td>
<td>::=</td>
<td>"while" "(" &lt;Expression&gt;<sub>↑&lt;exp_type&gt;,&lt;exp_value&gt;</sub></td>
</tr>
<tr>
<td></td>
<td></td>
<td>@checkType<sub>↓&lt;exp_type&gt;,BooleanType</sub></td>
</tr>
<tr>
<td></td>
<td></td>
<td>")" &lt;Statement&gt;</td>
</tr>
<tr>
<td></td>
<td></td>
<td>@generateCode<sub>↓&lt;stmt_type&gt;=stmt_while,&lt;extra_para&gt;</sub></td>
</tr>
</tbody>
</table>
&nbsp;
<h3>打印语句（PrintStatement）</h3>
<table>
<tbody>
<tr>
<td>&lt;PrintStatement&gt;</td>
<td>::=</td>
<td>"System.out.println" "("</td>
</tr>
<tr>
<td></td>
<td></td>
<td>&lt;Expression&gt;<sub>↑&lt;exp_type&gt;,&lt;exp_value&gt;</sub></td>
</tr>
<tr>
<td></td>
<td></td>
<td>@checkType<sub>↓&lt;exp_type&gt;,IntegerType</sub></td>
</tr>
<tr>
<td></td>
<td></td>
<td>")" ";"</td>
</tr>
<tr>
<td></td>
<td></td>
<td>@generateCode<sub>↓&lt;stmt_type&gt;=stmt_print,&lt;extra_para&gt;</sub></td>
</tr>
</tbody>
</table>
&nbsp;
<h3>属性及动作解释</h3>
<h4>动作</h4>
<table>
<tbody>
<tr>
<th>动作</th>
<th>作用</th>
</tr>
<tr>
<td>@checkTable<sub>↓&lt;id_name&gt;,&lt;id_level&gt;</sub></td>
<td>检查标识符的合法性（遍历符号表）</td>
</tr>
<tr>
<td>@checkTable<sub>↓&lt;class_name&gt;</sub></td>
<td>检查类名是否已声明</td>
</tr>
<tr>
<td>@checkTable<sub>↓&lt;id_name&gt;</sub><sub>↑&lt;id_type&gt;</sub></td>
<td>检查变量是否已声明，若已声明返回变量类型</td>
</tr>
<tr>
<td>@checkTable<sub>↓&lt;id_type&gt;</sub></td>
<td>检查类型是否已声明</td>
</tr>
<tr>
<td>@fillTable<sub>↓&lt;id_name1&gt;,&lt;id_address&gt;</sub></td>
<td>将标识符插入符号表</td>
</tr>
<tr>
<td>@fillTable<sub>↓&lt;child_name&gt;</sub><sub>,&lt;parent_name&gt;,&lt;id_address&gt;</sub></td>
<td>将子类插入符号表，同时复制父类的方法和类变量至子类</td>
</tr>
<tr>
<td>@fillTable<sub>↓&lt;id_name&gt;,&lt;id_belongsTo&gt;</sub></td>
<td>将标识符插入符号表</td>
</tr>
<tr>
<td>@fillTable<sub>↓&lt;id_name&gt;,&lt;id_sort&gt;,&lt;id_level&gt;,&lt;id_type&gt;</sub></td>
<td>将标识符插入符号表</td>
</tr>
<tr>
<td>@fillMemory<sub>↓&lt;id_name&gt;</sub><sub>↑&lt;id_address&gt;</sub></td>
<td>登记内存，返回地址</td>
</tr>
<tr>
<td>@generateCode<sub>↓&lt;stmt_type&gt;,&lt;extra_para&gt;</sub></td>
<td>生成伪代码</td>
</tr>
<tr>
<td>@checkType<sub>↓&lt;child_name&gt;,&lt;parent_name&gt;</sub></td>
<td>检查类型合法性（遍历继承树、符号表）</td>
</tr>
<tr>
<td>@checkType<sub>↓&lt;id_type&gt;,&lt;exp_type&gt;</sub></td>
<td>检查变量类型与表达式类型是否匹配</td>
</tr>
<tr>
<td>@checkTree<sub>↓&lt;child_name&gt;,&lt;parent_name&gt;</sub></td>
<td>检查child_name是否是parent_name的子类（遍历继承树）</td>
</tr>
<tr>
<td>@checkTree<sub>↓&lt;class_name&gt;</sub></td>
<td>检查child_name是否已存在于继承树内</td>
</tr>
<tr>
<td>@fillTree<sub>↓&lt;child_name&gt;,&lt;parent_name&gt;</sub></td>
<td>将child_name插入继承树中parent_name下</td>
</tr>
<tr>
<td>@fillTree<sub>↓&lt;node_name&gt;</sub></td>
<td>将node_name插入继承树中（父类为Object）</td>
</tr>
</tbody>
</table>
&nbsp;
<h4>属性</h4>
<table>
<tbody>
<tr>
<th>属性</th>
<th>数据类型（针对Java语言）</th>
<th>含义</th>
</tr>
<tr>
<td>id_name</td>
<td>String</td>
<td>标识符名称</td>
</tr>
<tr>
<td>id_level</td>
<td>int</td>
<td>标识符的层次结构</td>
</tr>
<tr>
<td>id_belongsTo</td>
<td>String</td>
<td>所属层次名称，（见附表）</td>
</tr>
<tr>
<td>id_address</td>
<td>int</td>
<td>内存地址</td>
</tr>
<tr>
<td>stmt_type</td>
<td>int</td>
<td>操作类型（见附表）</td>
</tr>
<tr>
<td>class_name</td>
<td>String</td>
<td>类名</td>
</tr>
<tr>
<td>extra_para</td>
<td>Object</td>
<td>附加参数</td>
</tr>
<tr>
<td>child_name</td>
<td>String</td>
<td>子类名称</td>
</tr>
<tr>
<td>parent_name</td>
<td>String</td>
<td>父类名称</td>
</tr>
<tr>
<td>class_name</td>
<td>String</td>
<td>类名</td>
</tr>
<tr>
<td>id_type</td>
<td>compiler.type.Type</td>
<td>变量类型类型（见附表）</td>
</tr>
<tr>
<td>para_list</td>
<td>java.util.List</td>
<td>参数表</td>
</tr>
<tr>
<td>exp_value</td>
<td>int或boolean或任何程序中已定义的对象类型</td>
<td>表达式值</td>
</tr>
<tr>
<td>exp_type</td>
<td>compiler.type.Type</td>
<td>表达式类型</td>
</tr>
</tbody>
</table>
&nbsp;
<h3>符号表结构</h3>
<table>
<tbody>
<tr>
<th>名称</th>
<th>数据类型（针对Java语言）</th>
<th>含义</th>
</tr>
<tr>
<td>name</td>
<td>String</td>
<td>标识符名称</td>
</tr>
<tr>
<td>sort</td>
<td>String</td>
<td>标识符类别</td>
</tr>
<tr>
<td>type</td>
<td>compiler.type.Type</td>
<td>变量类型</td>
</tr>
<tr>
<td>belongsTo</td>
<td>String</td>
<td>归属信息（见附表）</td>
</tr>
<tr>
<td>address</td>
<td>int</td>
<td>存储地址</td>
</tr>
</tbody>
</table>
&nbsp;
<h3>内存分配表结构</h3>
<table>
<tbody>
<tr>
<th>名称</th>
<th>数据类型（针对Java语言）</th>
<th>含义</th>
</tr>
<tr>
<td>address</td>
<td>int</td>
<td>标识符地址</td>
</tr>
<tr>
<td>sort</td>
<td>String</td>
<td>标识符类别</td>
</tr>
<tr>
<td>name</td>
<td>String</td>
<td>标识符名称</td>
</tr>
<tr>
<td>value</td>
<td>Object</td>
<td>标识符值</td>
</tr>
</tbody>
</table>
&nbsp;
<h3>附表</h3>
<h4>stmt_type</h4>
<table>
<tbody>
<tr>
<th>名称</th>
<th>值</th>
<th>含义</th>
</tr>
<tr>
<td>stmt_assign</td>
<td>1</td>
<td>赋值语句</td>
</tr>
<tr>
<td>stmt_array_assign</td>
<td>2</td>
<td>数组元素赋值语句</td>
</tr>
<tr>
<td>stmt_if</td>
<td>3</td>
<td>if语句</td>
</tr>
<tr>
<td>stmt_while</td>
<td>4</td>
<td>while语句</td>
</tr>
<tr>
<td>stmt_print</td>
<td>5</td>
<td>打印语句</td>
</tr>
</tbody>
</table>
&nbsp;
<h4>id_type</h4>
<table>
<tbody>
<tr>
<th>类</th>
<th>含义</th>
<th>size（字长（bytes））</th>
</tr>
<tr>
<td>ArrayType</td>
<td>整型数组类型</td>
<td>4</td>
</tr>
<tr>
<td>BooleanType</td>
<td>布尔类型</td>
<td>1</td>
</tr>
<tr>
<td>IntegerType</td>
<td>整型类型</td>
<td>4</td>
</tr>
<tr>
<td>ObjectType</td>
<td>对象类型</td>
<td>不确定</td>
</tr>
<tr>
<td>NonVariableType</td>
<td>非变量</td>
<td>0</td>
</tr>
</tbody>
</table>
&nbsp;
<h4>id_belongsTo</h4>
<table>
<tbody>
<tr>
<th>标识符类型</th>
<th>“belongsTo”属性内容</th>
</tr>
<tr>
<td>类</td>
<td>无（分析时以文件为单位）</td>
</tr>
<tr>
<td>方法</td>
<td>类名</td>
</tr>
<tr>
<td>类变量</td>
<td>类名</td>
</tr>
<tr>
<td>方法内变量</td>
<td>方法名</td>
</tr>
<tr>
<td>参数</td>
<td>方法名</td>
</tr>
</tbody>
</table>